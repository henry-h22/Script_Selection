The search is straightforward dynamic programming